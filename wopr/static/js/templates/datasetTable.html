<% var matrix = "/api/master/?" + $.param(query) + '&datatype=csv' %>
<p><a href="<%= matrix %>">Download data matrix</a></p>
<table class="table-striped table-condensed table">
    <thead>
        <tr>
            <th>Dataset Name</th>
            <th>Overview</th>
            <th>Points</th>
            <th>Detail</th>
        </tr>
    </thead>
    <tbody>
        <% $.each(objects, function(i, obj){ %>
            <% var points = "/api/detail/?" + $.param(query) + '&dataset_name=' + obj.meta.dataset_name %>
            <% var detail = "/map/detail/" + obj.meta.dataset_name + '/?' + $.param(query) %>
            <tr>
                <td><%= obj.meta.human_name %></td>
                <td><span id="<%= obj.meta.dataset_name %>-sparkline">Loading...</span></td>
                <td>
                    <div class="btn-group">
                        <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown">
                            Download
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="<%= points + '&datatype=csv' %>" class="data-download" target="_blank">CSV</a></li>
                            <li><a href="<%= points %>" class="data-download" target="_blank">JSON</a></li>
                        </ul>
                    </div>
                </td>
                <td>
                    <a href="javascript://" class="detail" data-dataset_name="<%= obj.meta.dataset_name %>">View</a>
                </td>
            </tr>
        <% }) %>
    </tbody>
</table>
